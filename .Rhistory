setwd("Documents/ML/Classification/SpamClassifier/")
easyham.docs <- dir(easyham.path)
library(tm)
spam.path <- 'data/spam'
library(tm)
easyham.path <- 'data/easyham'
get.msg <- function(path){
con <- file(path,open="rt",encoding="latin1")
text <- readLines(con)
msg <- text [seq(which(text=="")[1]+1,length(text),1)]
close(con)
return(paste(msg,collapse="\n"))
}
spam.docs <- dir(spam.path)
spam.docs <- spam.docs[which(spam.docs!="cmds")]
all.spam <- sapply(spam.docs,function(p)get.msg(paste(spam.path,p,sep="/")))
easyham.docs <- dir(easyham.path)
easyham.docs <- easyham.docs[which(easyham.docs != "cmds")]
easyham.docs <- dir(easyham.path)
easyham.path <- 'data/easyham'
easyham.path <- 'data/easy_ham'
easyham.docs <- dir(easyham.path)
easyham.docs <- easyham.docs[which(easyham.docs != "cmds")]
all.easyham <- sapply(easyham.docs[1:length(spam.docs)],
function(p) get.msg(paste(easyham.path,p,sep="/")))
head(all.spam)
head(all.easyham)
easyham.tdm <- get.tdm(all.easyham)
get.tdm <- function(doc.vec) {
doc.corpus <- Corpus(VectorSource(doc.vec))
control <- list(stopwords=TRUE,removePunctuation=TRUE,removeNumbers=TRUE,minDocFreq=2)
doc.tdm <- TermDocumentMatrix(doc.corpus,control)
return(doc.tdm)
}
spam.tdm <- get.tdm(all.spam)
easyham.tdm <- get.tdm(all.easyham)
easyham.counts <- rowSums(easyham.matrix)
easyham.matrix <- as.matrix(easyham.tdm)
easyham.counts <- rowSums(easyham.matrix)
easyham.df <- data.frame(cbind(names(easyham.counts),
as.numeric(easyham.counts)),stringsAsFactors=FALSE)
names(easyham) <- c('term','frequency')
names(easyham.df) <- c('term','frequency')
easyham.df$frequency <- as.numeric(easyham.df$frequency)
spam.matrix <- as.matrix(spam.tdm)
spam.counts <- rowSums(spam.matrix)
spam.df <- data.frame(cbind(names(spam.counts),
as.numeric(spam.counts)),stringsAsFactors=FALSE)
names(spam.df) <- c('term','frequency')
spam.df$frequency <- as.numeric(spam.df$frequency)
spam.occurence <- sapply(1:nrow(spam.matrix), function(i)
{length(which(spam.matrix[i,]>0))/ ncol(spam.matrix)})
spam.density <- spam.df$frequency / sum(spam.df$frequency)
spam.df <- transform(spam.df,density = spam.density, occurence = spam.occurence)
easyham.occurrence <- sapply(1:nrow(easyham.matrix),
function(i){length(which(easyham.matrix[i,]>0))/ncol(easyham.matrix)})
easyham.density <- easyham.df$frequency /sum(easyham.df$frequency)
easyham.df <- transform(easyham.df,occurrence =easyham.occurrence,density=easyham.density)
head(easyham.df[with(easyham.df,order(-occurrence))])
head(easyham.df[with(easyham.df,order(-occurrence)),])
